<!doctype html><html lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>Make recipes fun again</title><meta content="I hate ads" name=description><style>html{flex-direction:column;height:100%;display:flex}body{color:#fff;background:#3e3e42;flex-direction:column;flex-grow:1;height:100%;display:flex}button{color:#fff;border-width:0;flex-grow:1;font-weight:700}button:hover{cursor:pointer}button:disabled{font-weight:400}#copy-from-clipboard-button{background:#338356}#copy-markdown-to-clipboard-button{background:#007acc}.hidden{display:none}.input{width:100%;display:flex}.input input{flex-grow:1}.output{color:#fff;flex-grow:1}</style><script>let State={None:0,Ingredients:1,Instructions:2,Notes:3};const SUBHEADER_PREFIX=`### `;const LI_PREFIX=`   - `;let extract_data=a=>{let b=new DOMParser();let c=b.parseFromString(a,`text/html`);let d=State.None;let e=null;let f=[];let g=[];let h=[];for(let a of c.querySelectorAll(`li,p,h1,h2,h3,h4,h5,h6`)){if(a.nodeName.startsWith(`H`)){if(a.nodeName==e){d=State.None};let b=!0;while(b){b=!1;for(let c of a.children){if(c.nodeName==`DIV`){a.removeChild(c);b=!0}}}};let b=a.textContent.trim().replace(`â–¢`,``);if(b.length==0){continue};let c=b.toLowerCase();switch(c){case `ingredients`:d=State.Ingredients;e=a.nodeName;continue;case `instructions`:d=State.Instructions;e=a.nodeName;continue;case `notes`:d=State.Notes;e=a.nodeName;continue;default:break}switch(a.nodeName){case `H1`:;case `H2`:;case `H3`:;case `H4`:;case `H5`:;case `H6`:;case `H7`:;case `H8`:;case `H9`:b=`${SUBHEADER_PREFIX}${b}`;break;default:b=`${LI_PREFIX}${b}`;break}switch(d){case State.Ingredients:f.push(b);break;case State.Instructions:g.push(b);break;case State.Notes:h.push(b);break;default:break}};return {ingredients:f,instructions:g,notes:h}};const get_markdown_list=(a,b)=>{let c=``;if(a.length){c+=`\n\n## ${b}\n`;for(let b of a){if(b.startsWith(SUBHEADER_PREFIX)){b=`\n\n${b}\n`}else{c+=`\n${b}`}}};return c};const data_to_markdown_string=a=>{let b=``;b+=get_markdown_list(a.ingredients,`Ingredients`);b+=get_markdown_list(a.instructions,`Instructions`);b+=get_markdown_list(a.notes,`Notes`);return b.trim()};window.onload=()=>{let k=`ul`,l=`click`;const a=document.querySelector(`#copy-from-clipboard-button`);const b=document.querySelector(`#copy-markdown-to-clipboard-button`);const c=document.querySelector(`.output`);let d={};const e=(a,b,d)=>{let e=document.createElement(a);if(b){e.textContent=b};if(d){d.appendChild(e)}else{c.appendChild(e)};return e};const f=a=>{c.innerHTML=``;g(a.ingredients,`Ingredients`);g(a.instructions,`Instructions`)};const g=(a,b)=>{if(a.length){e(`h2`,b);let c=e(k);for(let b of a){if(b.startsWith(LI_PREFIX)){b=b.substr(LI_PREFIX.length)}else if(b.startsWith(SUBHEADER_PREFIX)){b=b.substr(SUBHEADER_PREFIX.length);e(`h3`,b);c=e(k);continue};e(`li`,b,c)}}};const h=a=>{fetch(`https://corsproxy.io/?url=${encodeURI(a)}`).then(a=>{a.text().then(a=>{d=extract_data(a);b.removeAttribute(`disabled`);f(d)})})};a.addEventListener(l,async()=>{const a=await navigator.clipboard.read();for(const b of a){for(const a of b.types){const c=await b.getType(a);const d=await c.text();h(d);return}}});b.addEventListener(l,async()=>{let a=data_to_markdown_string(d);console.log({markdown:a});await navigator.clipboard.writeText(a)});let i=new URL(document.location);const j=i.searchParams.get(`link`)||i.searchParams.get(`description`)||i.searchParams.get(`url`);if(j){h(decodeURI(j))}}</script><link href=manifest.json rel=manifest></head><body><div class=input><button id=copy-from-clipboard-button>Copy recipe from clipboard</button><button disabled id=copy-markdown-to-clipboard-button>Copy markdown</button></div><div class=output>This is meant to be run as a progressive web app.</div><script>`use strict`;(()=>{let h=`0`,g=`div`;const a=`{{__TRUNK_ADDRESS__}}`;const b=`{{__TRUNK_WS_BASE__}}`;let c=``;c=c?c:window.location.protocol===`https:`?`wss`:`ws`;const d=c+ `://`+ a+ b+ `.well-known/trunk/ws`;class e{constructor(){this._overlay=document.createElement(g);const a=this._overlay.style;a.height=`100vh`;a.width=`100vw`;a.position=`fixed`;a.top=h;a.left=h;a.backgroundColor=`rgba(222, 222, 222, 0.5)`;a.fontFamily=`sans-serif`;a.zIndex=`1000000`;a.backdropFilter=`blur(1rem)`;const b=document.createElement(g);b.style.position=`absolute`;b.style.top=`30%`;b.style.left=`15%`;b.style.maxWidth=`85%`;this._title=document.createElement(g);this._title.innerText=`Build failure`;this._title.style.paddingBottom=`2rem`;this._title.style.fontSize=`2.5rem`;this._message=document.createElement(g);this._message.style.whiteSpace=`pre-wrap`;const c=document.createElement(g);c.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="#dc3545" viewBox="0 0 16 16"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>`;this._title.prepend(c);b.append(this._title,this._message);this._overlay.append(b);this._inject();window.setInterval(()=>{this._inject()},250)}reason(a){this._message.textContent=a}_inject(){if(!this._overlay.isConnected){document.body?.prepend(this._overlay)}}}class f{constructor(a){this.url=a;this.poll_interval=5000;this._overlay=null}start(){const a=new WebSocket(this.url);a.onmessage=a=>{const b=JSON.parse(a.data);switch(b.type){case `reload`:this.reload();break;case `buildFailure`:this.buildFailure(b.data);break}};a.onclose=()=>this.onclose()}onclose(){window.setTimeout(()=>{const a=new WebSocket(this.url);a.onopen=()=>window.location.reload();a.onclose=()=>this.onclose()},this.poll_interval)}reload(){window.location.reload()}buildFailure({reason:a}){console.error(`Build failed:`,a);console.debug(`Overlay`,this._overlay);if(!this._overlay){this._overlay=new e()};this._overlay.reason=a}}new f(d).start()})()</script></body></html>